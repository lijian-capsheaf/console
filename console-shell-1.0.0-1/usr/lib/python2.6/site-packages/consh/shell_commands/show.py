#!/usr/bin/python
# -*- coding: utf-8 -*-

import math
import consh.ansi as ansi

__capability__ = 7

def show(cmd, *args, **argv):
    """
...     
_n      show commands
_f      show []
        
    """
    
    context = argv["context"]
       
    commands = context.commands
    context.resolver.import_module(context.commands)
    from _prettytable import PrettyTable
    cmd_title = ansi.RED + ansi.BOLD + "commands:" + ansi.RESET
    cmd_desc = ansi.RED + ansi.BOLD + "description:" + ansi.RESET
    pt =  PrettyTable([cmd_title, cmd_desc])
    pt.align = "l"
    pt.valign = "t"
    pt.border = False
    for command in commands:
        module = context.resolver.get_module(command)
        func = context.resolver.get_func(module,command)
        note = context.resolver.get_func_doc(func)["note"]
        notes = note.split("\n")
        note = "".join(notes)
        cmd_n = ansi.BOLD + ansi.GREEN + command + ansi.RESET
        cmd_d = ansi.BOLD + ansi.GREEN +note + ansi.RESET
        pt.add_row([cmd_n, cmd_d])
    
    context.write("%s%s%s" % (ansi.YELLOW, pt.get_string(), ansi.RESET))
