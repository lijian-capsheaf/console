# -*- coding: utf-8 -*-

__capability__ = 6

def arp(cmd, *args, **argv):
    """
...     
_n      look at the table of 'arp' 
_f      arp [show|del|set|flush|fromconfig] IP/MAC
	arp [show]			show table about ARP
	arp [del] IP [Iface]		del a record from ARP table about Iface
        arp [set] IP MAC [Iface]	add a record to ARP table about Iface
	arp [flush]			delete all solidified arp entry
	arp [fromconfig]		update the ARP table from the configuration file"""
    
    def arp_show():
        from _arp_deal import arp as show_arp
        arplists = show_arp()
	from _prettytable import PrettyTable
	arp_t = PrettyTable(["IPadress", "HWaddress", "Flags", "Iface"])
	arp_t.align = "l"
	arp_t.padding_width = 1
	arp_t.border = False
	for arplist in arplists:
            arp_t.add_row(arplist)
	
        context.write("%s" % arp_t)
     
   
    context = argv["context"]

    leng = len(args)
    if leng:
        cmd_next = args[0]
        args = list(args)
        args.pop(0)
        context.func_next(cmd, cmd_next, args)

    else:
        arp_show()
