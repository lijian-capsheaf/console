# -*- coding: utf-8 -*-

__capability__ = 6

def arp_set(cmd, *args, **argv):
    """
    """
    context = argv["context"]

    from _arp_deal import arp_set as set_arp
    
    leng = len(args)
    
    import re
    def isValidMac(mac):  
        if re.match(r"^\s*([0-9a-fA-F]{2,2}:){5,5}[0-9a-fA-F]{2,2}\s*$", mac): 
            return mac  
        return None 

    if leng  > 1:
        import socket
        try:
            ip = socket.gethostbyname(args[0])
        except:
            context.write("unknown host %s" % args[0])
            return
        mac = isValidMac(args[1])
        if mac == None:
            context.write("unknown mac %s" % args[1])
            return
        interface = ""
        if leng > 2:
            interface = args[2]
        
        exit_state = set_arp(ip, mac, interface)
        if exit_state == True:
            pass
        else:
            context.write("%s"% exit_state)

    else:
        context.write("%s:Unknown interface"% cmd)
        return

